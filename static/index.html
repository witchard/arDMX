<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lighting</title>
    <link rel="stylesheet"  href="css/themes/default/jquery.mobile-1.3.1.min.css">
    <script src="js/jquery.js"></script>
    <script src="js/jquery.mobile-1.3.1.min.js"></script>
</head>
<body>
  <div data-role="header" data-position="fixed">
    <p>
      <button data-icon="star" id="set">Set Lights</button>
    </p>
  </div>

  <div class="sliders">
    <!-- Empty space for our sliders -->
  </div>

  <script>
    $(document).bind('pageinit', function() {
      // Create sliders from config array below
      var sliders = [ {name: "Test", channel: 3},
                      {name: "Foo", channel: 4} ];
      sliders = jQuery.map( sliders, function(i) {
        return '<div data-role="fieldcontain">' +
                  '<label for="slider-' + i.channel + '">' + i.name + '</label>' +
                  '<input type="range" name="' + i.channel + '" id="slider-' + i.channel + '" value="0" min="0" max="255" data-highlight="true"/>' +
               '</div>';
        });
      $(".sliders").append(sliders).trigger("create");
    });

    $("#set").bind( "click", function(event, ui) {
      // Send values as json blob
      $.ajax({
        url: "set_values", 
        data: JSON.stringify({ name: "John", time: "2pm" }), 
        contentType: 'application/json',
        dataType: 'json',
        type: 'POST'})
        .done(function( json ) {
          alert( "JSON Data: " + JSON.stringify(json) );
        })
        .fail(function( jqxhr, textStatus, error ) {
          alert( "Request Failed: " + textStatus + ", " + error );
        });
    });
  </script>


</body>
